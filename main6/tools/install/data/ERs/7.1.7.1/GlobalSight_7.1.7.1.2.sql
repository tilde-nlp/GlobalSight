# For gbs-799
#DROP TABLE IF EXISTS ATTRIBUTE_SET CASCADE;
CREATE TABLE ATTRIBUTE_SET
(
  ID BIGINT AUTO_INCREMENT PRIMARY KEY,
  NAME VARCHAR(40),
  DESCRIPTION  VARCHAR(4000),
  COMPANY_ID BIGINT NOT NULL,
  CONSTRAINT FK_ATTRIBUTE_SET_COMPANYID FOREIGN KEY (COMPANY_ID) REFERENCES COMPANY(ID)
) AUTO_INCREMENT = 1000;

#DROP TABLE IF EXISTS ATTRIBUTE CASCADE;
CREATE TABLE ATTRIBUTE
(
  ID BIGINT AUTO_INCREMENT PRIMARY KEY,
  NAME VARCHAR(40) UNIQUE NOT NULL,
  DISPLAY_NAME VARCHAR(40) NOT NULL,
  DESCRIPTION  VARCHAR(4000),
  COMPANY_ID BIGINT NOT NULL,
  VISIBLE CHAR(1) NOT NULL CHECK(VISIBLE IN ('Y','N')),
  EDITABLE CHAR(1) NOT NULL CHECK(EDITABLE IN ('Y','N')),
  REQUIRED CHAR(1) NOT NULL CHECK(REQUIRED IN ('Y','N')),
  CONDITION_ID BIGINT NOT NULL,
  TYPE VARCHAR(40),
  CONSTRAINT FK_ATTRIBUTE_COMPANYID FOREIGN KEY (COMPANY_ID) REFERENCES COMPANY(ID)
) AUTO_INCREMENT = 1000;

#DROP TABLE IF EXISTS LIST_CONDITION CASCADE;
CREATE TABLE LIST_CONDITION
(
  ID BIGINT AUTO_INCREMENT PRIMARY KEY,
  MULTIPLE CHAR(1) NOT NULL CHECK(MULTIPLE IN ('Y','N'))
) AUTO_INCREMENT = 1000;

#DROP TABLE IF EXISTS INT_CONDITION CASCADE;
CREATE TABLE INT_CONDITION
(
  ID BIGINT AUTO_INCREMENT PRIMARY KEY,
  MAX BIGINT,
  MIN BIGINT
) AUTO_INCREMENT = 1000;

#DROP TABLE IF EXISTS DATE_CONDITION CASCADE;
CREATE TABLE DATE_CONDITION
(
  ID BIGINT AUTO_INCREMENT PRIMARY KEY
) AUTO_INCREMENT = 1000;

#DROP TABLE IF EXISTS TEXT_CONDITION CASCADE;
CREATE TABLE TEXT_CONDITION
(
  ID BIGINT AUTO_INCREMENT PRIMARY KEY,
  LENGTH BIGINT
) AUTO_INCREMENT = 1000;

#DROP TABLE IF EXISTS FLOAT_CONDITION CASCADE;
CREATE TABLE FLOAT_CONDITION
(
  ID BIGINT AUTO_INCREMENT PRIMARY KEY,
  MAX DOUBLE,
  MIN DOUBLE,
  DEFINITION BIGINT
) AUTO_INCREMENT = 1000;

#DROP TABLE IF EXISTS FILE_CONDITION CASCADE;
CREATE TABLE FILE_CONDITION
(
  ID BIGINT AUTO_INCREMENT PRIMARY KEY
) AUTO_INCREMENT = 1000;

#DROP TABLE IF EXISTS SELECT_OPTION CASCADE;
CREATE TABLE SELECT_OPTION
(
  ID BIGINT AUTO_INCREMENT PRIMARY KEY,
  VALUE VARCHAR(300),
  LIST_CONDITION_ID BIGINT not null
) AUTO_INCREMENT = 1000;

#DROP TABLE IF EXISTS ATTRIBUTE_SET_ATTRIBUTE CASCADE;
CREATE TABLE ATTRIBUTE_SET_ATTRIBUTE
(
  ATTRIBUTE_ID BIGINT,
  SET_ID BIGINT
) AUTO_INCREMENT = 1000;

#DROP TABLE IF EXISTS JOB_ATTRIBUTE CASCADE;
CREATE TABLE JOB_ATTRIBUTE
(
  ID BIGINT AUTO_INCREMENT PRIMARY KEY,
  INTEGER_VALUE INTEGER,
  FLOAT_VALUE DOUBLE,
  STRING_VALUE VARCHAR(4000),
  DATE_VALUE DATETIME,
  JOB_ID BIGINT NOT NULL,
  ATTRIBUTE_ID BIGINT NOT NULL
) AUTO_INCREMENT = 1000;

#DROP TABLE IF EXISTS FILE_VALUE_ITEM CASCADE;
CREATE TABLE FILE_VALUE_ITEM
(
  ID BIGINT AUTO_INCREMENT PRIMARY KEY,
  PATH VARCHAR(300),
  JOB_ATTRIBUTE_ID BIGINT NOT NULL
) AUTO_INCREMENT = 1000;

#DROP TABLE IF EXISTS JOB_ATTRIBUTE_SELECT_OPTION CASCADE;
CREATE TABLE JOB_ATTRIBUTE_SELECT_OPTION
(
  JOB_ATTRIBUTE_ID BIGINT,
  SELECT_OPTION_ID BIGINT
) AUTO_INCREMENT = 1000;

ALTER TABLE PROJECT ADD COLUMN ATTRIBUTE_SET_ID BIGINT;

CREATE INDEX IDX_JOB_ATTRIBUTE_JOB_ID ON JOB_ATTRIBUTE(JOB_ID);
CREATE INDEX IDX_JOB_ATTRIBUTE_ATTRIBUTE_ID ON JOB_ATTRIBUTE(ATTRIBUTE_ID);
CREATE INDEX IDX_ATTRIBUTE_COMPANY_ID ON ATTRIBUTE(COMPANY_ID);
CREATE INDEX IDX_ATTRIBUTE_NAME ON ATTRIBUTE(NAME);
CREATE INDEX IDX_ATTRIBUTE_DISPLAY_NAME ON ATTRIBUTE(DISPLAY_NAME);
CREATE INDEX IDX_ATTRIBUTE_SET_COMPANY_ID ON ATTRIBUTE_SET(COMPANY_ID);