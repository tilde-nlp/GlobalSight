ALTER TABLE WORKFLOW ADD COLUMN FUZZY_MED_REPETITION_WORD_COUNT int(10);
ALTER TABLE WORKFLOW ADD COLUMN FUZZY_MED_HI_REPETITION_WORD_COUNT int(10);
ALTER TABLE WORKFLOW ADD COLUMN FUZZY_HI_REPETITION_WORD_COUNT int(10);

ALTER TABLE WORKFLOW ADD COLUMN THRESHOLD_FUZZY_HI_WORD_COUNT int(10);
ALTER TABLE WORKFLOW ADD COLUMN THRESHOLD_FUZZY_MED_HI_WORD_COUNT int(10);
ALTER TABLE WORKFLOW ADD COLUMN THRESHOLD_FUZZY_MED_WORD_COUNT int(10);
ALTER TABLE WORKFLOW ADD COLUMN THRESHOLD_FUZZY_LOW_WORD_COUNT int(10);
ALTER TABLE WORKFLOW ADD COLUMN THRESHOLD_NO_MATCH_WORD_COUNT int(10);

ALTER TABLE `RATE` CHANGE COLUMN `NO_MATCH_REPETITION_RATE` `REPETITION_RATE` FLOAT NOT NULL;
ALTER TABLE `RATE` CHANGE COLUMN `NO_MATCH_REPETITION_RATE_PER` `REPETITION_RATE_PER` FLOAT NOT NULL;

ALTER TABLE TARGET_PAGE ADD COLUMN THRESHOLD_FUZZY_HI_WORD_COUNT int(10);
ALTER TABLE TARGET_PAGE ADD COLUMN THRESHOLD_FUZZY_MED_HI_WORD_COUNT int(10);
ALTER TABLE TARGET_PAGE ADD COLUMN THRESHOLD_FUZZY_MED_WORD_COUNT int(10);
ALTER TABLE TARGET_PAGE ADD COLUMN THRESHOLD_FUZZY_LOW_WORD_COUNT int(10);
ALTER TABLE TARGET_PAGE ADD COLUMN THRESHOLD_NO_MATCH_WORD_COUNT int(10);

ALTER TABLE TRANSLATION_UNIT ADD COLUMN REPETITION_OF_ID BIGINT DEFAULT NULL;
CREATE INDEX REPETITION_OF_ID ON TRANSLATION_UNIT (REPETITION_OF_ID);
ALTER TABLE TRANSLATION_UNIT ADD COLUMN IS_REPEATED CHAR(1) DEFAULT 'N'
     CHECK (IS_REPEATED IN ('Y', 'N'));
     
UPDATE WORKFLOW a 
SET a.FUZZY_MED_REPETITION_WORD_COUNT = 0, a.FUZZY_MED_HI_REPETITION_WORD_COUNT = 0,
a.FUZZY_HI_REPETITION_WORD_COUNT = 0,
a.THRESHOLD_FUZZY_HI_WORD_COUNT = a.FUZZY_HI_WORD_COUNT,
a.THRESHOLD_FUZZY_MED_HI_WORD_COUNT = a.FUZZY_MED_HI_WORD_COUNT,
a.THRESHOLD_FUZZY_MED_WORD_COUNT = a.FUZZY_MED_WORD_COUNT,
a.THRESHOLD_FUZZY_LOW_WORD_COUNT = 0,
a.THRESHOLD_NO_MATCH_WORD_COUNT = a.NO_MATCH_WORD_COUNT + a.SUB_LEV_MATCH_WORD_COUNT
where a.FUZZY_MED_REPETITION_WORD_COUNT is NULL;

UPDATE TARGET_PAGE a 
SET a.THRESHOLD_FUZZY_HI_WORD_COUNT = a.FUZZY_HI_WORD_COUNT,
a.THRESHOLD_FUZZY_MED_HI_WORD_COUNT = a.FUZZY_MED_HI_WORD_COUNT,
a.THRESHOLD_FUZZY_MED_WORD_COUNT = a.FUZZY_MED_WORD_COUNT,
a.THRESHOLD_FUZZY_LOW_WORD_COUNT = 0,
a.THRESHOLD_NO_MATCH_WORD_COUNT = a.NO_MATCH_WORD_COUNT + a.FUZZY_LOW_WORD_COUNT
where a.THRESHOLD_FUZZY_HI_WORD_COUNT is NULL;